<html>
<head>
<title>Raspberry Pi3 Starter Kit Lesson 9: Drive a Relay to Control LED</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" href="css/style.css" type="text/css">
</head>

 <p style="text-align: left;">
    <span style="font-size: 48px;"><img src="..\..\AboutThisKit\osoyoo_logo.jpg" title="" alt="osyoo logo.jpg"/></span>
</p>
<p href ="www.osoyoo.com" align="right" class="TOC" size=="50"><b>www.osoyoo.com/?p=11587</b></p>
<hr />
<body>
<a href="../index.html"><font face=Arial>Back to Raspberry Pi Tutoial Index Page</a>
<hr >
<h1>Raspberry Pi Starter Kit Lesson 9: Drive a Relay to Control LED</h1>
<center><video width="920" height="720" controls>
  <source src="..\..\Videos\Lesson_9_Drive_a _Relay _to_ control_led.mp4" type="video/mp4">
Your browser does not support the video tag.
</video></center>
<ul>
<li><strong><a href="#1">Overview</a></strong></li>
<li><strong><a href="#2">Hardware Preparation</a></strong></li>
<li><strong><a href="#3">Software Preparation</a></strong></li>
<li><strong><a href="#4">Work Principle</a></strong></li>
<li><strong><a href="#5">Hardware Setup</a></strong></li>
<li><strong><a href="#6">Software</a></strong></li>
<li><strong><a href="#7">For C language users</a></strong></li>
<li><strong><a href="#8">For python users</a></strong></li>
</ul>
<p><a id="1"></a><strong>Overview</strong></p>
<p>In this lesson,we'll learn how to use Raspberry Pi to drive a relay to switch on/off LED</p>
<p><a id="2"></a><b>Hardware Preparation</b></p>
<p>1 * Raspberry Pi<br />
1 * Breadboard<br />
1 * Relay<br />
1 * LED<br />
1 * Resistor (200Ω)<br />
Several jumper wires</p>
<p><a id="3"></a><b>Software Preparation</b><br />
Please visit <a href="../Lesson 1 Get Started with Raspberry Pi/index.html">Getting started for raspberry pi</a></p>
<p><a id="4"></a><strong>Work Principle</strong><br />
Relay is an electronic switch which allows low power digital signal to turn on/off a high power circuit.  A relay has at least one pair of input pins and one pair output pins(output switch). When input gets digital signal 1 (high voltage), Relay will make output switch on. If Input pins get digit zero, it will make output switch off.</p>
<p>The construction and working of a relay can be understood from the below diagram.</p>
<p><center><img src=".\image\1.jpg" width="884" height="707" /></center></p>
<p><center><img class="aligncenter size-medium" src=".\image\2.gif" width="828" height="420" /></center></p>
<p><center><img class="aligncenter size-medium" src=".\image\3.jpg" width="828" height="420" /></center></p>
<p><center><img class="aligncenter size-medium" src=".\image\4.jpg" width="828" height="420" /></center></p>
<strong>Hardware Setup</strong></p>
<p>Assembling the Circuit as per following Connection Graph, the relay output to LED, the relay signal lead to Raspberry Pi GPIO 0(BCM_GPIO 17). When a high voltage is applied to relay, the LED will light up. when a low voltage(0V) is applied to relay. The LED will turn off.</p>
<p><span style="color: #ff00ff;"><center><a href=".\image\5.jpg"><img class="aligncenter wp-image-7733 size-large" src=".\image\5.jpg" alt="" width="1024" height="683" /></a></center></span></p>
<p><a id="6"></a><strong>Sample Code</strong></p>
<p>We’ll provide two kinds of codes for C language users and Python language users.</p>
<p><a id="7"></a><strong>For C Language users, please follow the next step:</strong></p>
<hr />
<p>Firstly, Please make sure the wiringPi library is installed, if you don’t know how to install it, please visit: <a href="../Lesson 1 Get Started with Raspberry Pi/index.html
" target="_blank" rel="noopener noreferrer">Raspberry Pi Starter Kit Lesson 1——Get Started with Raspberry Pi</a></p>
<p><strong>Step 1)Download sample code relay_with_led.c from osoyoo.com by typing following commands:</strong></p>
<p><span style="color: #ff00ff;"><strong>cd  ~</strong></span></p>
<p><span style="color: #ff00ff;"><strong>sudo  wget  http://osoyoo.com/driver/pi3_start_learning_kit_lesson_9/relay_with_led.c</strong></span></p>
<p><center><a href=".\image\6.jpg"><img class="wp-image-7909 size-full aligncenter" src=".\image\6.jpg" alt="" width="693" height="300" /></a></center></p>
<p>If you want to customize the sample code file , you can use nano editor to edit source code by typing following command:<br />
<span style="color: #ff00ff;"><strong>sudo nano relay_with_led.c</strong></span></p>
<p><strong>Step 2) Compile Code</strong><br />
C language is high level language. Before running the project, the source code needs to be compiled as an executable file. Please compile the <strong>relay_with_led.c</strong> file by typing following command:<br />
<span style="color: #ff00ff;"><strong>gcc  -Wall  -o  relay_with_led   relay_with_led.c  -lwiringPi</strong></span><br />
<strong>Note: gcc: </strong>is GNU Compiler Collection. If you want to write your own C code and compile to run it, you need to master gcc. for more information about gcc, please visit <a href="https://gcc.gnu.org/onlinedocs/gcc-2.95.2/gcc_2.html">https://gcc.gnu.org/onlinedocs/gcc-2.95.2/gcc_2.html</a><br />
<strong>-Wall:</strong> to get more error when compile the code<br />
<strong>-o</strong>: to name the compiled file. You can name the file as your like. here we name as relay_with_led<br />
<strong>flow_led.c</strong>: means the original file which is compiled<br />
<strong>-lwiringPi</strong>: is to load the library wiringPi (l is short for library)</p>
<p><strong>Step 3)Run the program</strong><br />
<span style="color: #ff00ff;"><strong>sudo  ./relay_with_led  </strong></span></p>
<p><a href=".\image\7.jpg"><center><img class="wp-image-7911 size-full aligncenter" src=".\image\7.jpg" alt="" width="927" height="485" /></center></a></p>
<p><strong>Step 4) Test Result</strong><br />
Once run the program, the replay will make tick-tock sound. In addition, you should see the LED Blink.</p>
<p><strong>C language Code Analysis</strong></p>
<pre class="easycode; title:;lang:;">#include < wiringPi.h >
#includeM < stdio.h >
#include < stdlib.h >

#define  RelayPin  0

int main(void){
    if(wiringPiSetup() == -1){ //when initialize wiring failed, print messageto screen
        printf("setup wiringPi failed !");
        exit(1); 
    }
    
    pinMode(RelayPin, OUTPUT);   //set GPIO0 output

    printf("\n");
    printf("|**************************************|\n");
    printf("|                 Relay                |\n");
    printf("|    ------------------------------    |\n");
    printf("| GPIO0 connect to relay's control pin |\n");
    printf("| led connect to relay's NormalOpen pin|\n");
    printf("|  5v connect to relay's COM pin       |\n");
    printf("|                                      |\n");
    printf("|      Make relay to control a led     |\n");
    printf("|                                      |\n");
    printf("|                                OSOYOO|\n");
    printf("|**************************************|\n");
    printf("\n");

    for(;;){
        // disconnect
        printf("|********************|\n");
        printf("|   ...Relay Close   |\n");
        printf("|********************|\n");
        digitalWrite(RelayPin, LOW);
        delay(1000);
        // connect
        printf("|********************|\n");
        printf("|   Relay Open...    |\n");
        printf("|********************|\n");
        digitalWrite(RelayPin, HIGH);
        delay(1000);
    }

    return 0;
}</pre>
<p><a id="8"></a><strong>For Python language user:</strong></p>
<hr />
<p>If your Raspberry Pi is connected with a Monitor through HDMI cable,then you can program in Python 3(IDLE) GUI environment directly,for more details please visit:<a href="../Lesson 4 Python Light LED/index.html">Lesson 4 Python Light LED</a></p>
<p>If your Pi is not connected with a monitor, you can use command line to remote access Pi through ssh client. for more details, please visit:<a href="../Lesson 1 Get Started with Raspberry Pi/index.html">Lesson 1 Get Started with Raspberry Pi</a><br />
</strong></p>
<p><strong>Step 1)</strong> download relay_with_led.py file by typing following command in terminal:</p>
<p><strong><span style="color: #ff00ff;">cd  ~</span></strong></p>
<p><span style="color: #ff00ff;"><strong>sudo  wget  http://osoyoo.com/driver/pi3_start_learning_kit_lesson_9/relay_with_led.py</strong></span></p>
<p><a href=".\image\8.jpg"><center><img class="wp-image-7914 size-full aligncenter" src=".\image\8.jpg" alt="" width="917" height="298" /></center></a></p>
<p>If you want to customize the sample code file , you can use nano editor to edit source code by typing following command:</p>
<p><strong><span style="color: #ff00ff;">sudo  nano  relay_with_led.py</span></strong></p>
<p><strong>Step 2) Run Program</strong></p>
<p><span style="color: #ff00ff;"><strong>sudo  python  ./relay_with_led.py</strong></span></p>
<p><strong><center><a href=".\image\9.jpg"><center><img class="wp-image-7910 size-full aligncenter" src=".\image\9.jpg" alt="" width="633" height="536" /></center></a></strong></center></p>
<p><strong>Step 3) Test Result</strong></p>
<p>Once run the program, the replay will make tick-tock sound. In addition, you should see the LED Blink.</p>
<p><strong>Python language Code Analysis</strong></p>
<pre class="easycode; title:;lang:;">import RPi.GPIO as GPIO
import time

# set BCM_GPIO 17 as relay pin
RelayPin = 17

#print message at the begining ---custom function
def print_message():
    print ('|**********************************************|')
    print ('|                     Relay                    |')
    print ('|        -----------------------------------   |')
    print ('|        GPIO0 connect to relay control pin    |')
    print ('|        led connect to relay NormalOpen pin   |')
    print ('|        5V connect to relay COM pin           |')
    print ('|        Make relay to control a led           |')
    print ('|        -----------------------------------   |')
    print ('|                                              |')
    print ('|                                        OSOYOO|')
    print ('|**********************************************|\n')
    print ('Program is running...')
    print ('Please press Ctrl+C to end the program...')
    print ('\n')

#setup function for some setup---custom function
def setup():
    GPIO.setwarnings(False)
    #set the gpio modes to BCM numbering
    GPIO.setmode(GPIO.BCM)
    #set RelayPin's mode to output,and initial level to LOW(0V)
    GPIO.setup(RelayPin,GPIO.OUT,initial=GPIO.LOW)

#main function
def main():
    #print info
    print_message()
    while True:
        print ('|******************|')
        print ('|  ...Relay close  |')
        print ('|******************|\n')
        
        #disconnect
        GPIO.output(RelayPin,GPIO.LOW)
        time.sleep(1)

        print ('|*****************|')
        print ('|  Relay open...  |')
        print ('|*****************|\n')
        print ('')
        #connect
        GPIO.output(RelayPin,GPIO.HIGH)
        time.sleep(1)

#define a destroy function for clean up everything after the script finished
def destroy():
    #turn off relay
    GPIO.output(RelayPin,GPIO.LOW)
    #release resource
    GPIO.cleanup()
#
# if run this script directly ,do:
if __name__ == '__main__':
    setup()
    try:
            main()
    #when 'Ctrl+C' is pressed,child program destroy() will be executed.
    except KeyboardInterrupt:
        destroy()</pre>
<center><h2><a href="../Lesson 8 Raspberry Pi Drive Active Buzzer/index.html"><img class="alignnone wp-image-6442 size-full" src=".\image\10.jpg" alt=".\image\10.jpg" width="156" height="41" /></a>                  <a href="../index.html"><img class="alignnone wp-image-6443 size-full" src=".\image\11.jpg" alt="" width="236" height="39" /></a>                  <a href="../Lesson 10 Raspberry Pi SPI Ports/index.html"><img class="alignnone size-full wp-image-6445" src=".\image\12.jpg" alt="" width="156" height="41" /></a></h2></center>
<br/>
<br/>
<br/>
<br/>
<br/>

